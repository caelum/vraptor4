<!DOCTYPE HTML> <html lang="pt"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <title>VRaptor 4 - Dependências e pré-requisitos</title> <link rel="shortcut icon" href="../../../img/favicon.png"> <link rel="stylesheet" href="/css/style.min.css"/> <meta name="generator" content="nanoc 3.6.7"> </head> <body> <header class="container"> <h1 class="logo"><a class="logo-link" href="../.."> <img src="../../../img/logo.png" alt="VRaptor"> </a></h1> <div class="header-links"> <ul class="community"> <li><a href="https://groups.google.com/forum/#!forum/caelum-vraptor" target="_blank">Google Groups</a></li> <li><a href="https://github.com/caelum/vraptor4/" target="_blank">GitHub</a></li> <li><a href="http://www.guj.com.br/tag/vraptor" target="_blank">GUJ Respostas</a></li> </ul> <ul class="site-languages"> <li> <a class="site-language flag flag-en not-selected" title="en" href="../../../en"> EN </a> </li> <li> <a class="site-language flag flag-pt " title="pt" href="../.."> PT </a> </li> </ul> <a href="../../busca/" class="site-search-link">Ir para a página de busca</a> <form action="/pt/busca/" method="get" class="site-search-form"> <input type="search" name="q"> <button type="submit">Buscar</button> </form> </div> </header> <input type="checkbox" id="nav-visibility"> <label for="nav-visibility" class="nav-toggle">Menu</label> <nav class="main-nav"> <ul> <li><a href="../../download">Download</a></li> <li><a href="../guia-de-1-minuto/">Documentação</a></li> <li><a href="../../cookbook/aceitando-urls-com-ou-sem-barra-no-final">Cookbook</a></li> <li><a href="https://github.com/caelum/vraptor4/releases" target="_blank">Changelog</a></li> <li><a href="https://github.com/caelum/vraptor4/milestones" target="_blank">Roadmap</a></li> <li><a href="../../../javadoc">Javadoc</a></li> </ul> </nav> <nav class="doc-nav container"> <h1>Documentação</h1> <ul> <li><a href="../guia-de-1-minuto">Guia inicial de 1 minuto</a></li> <li><a href="../guia-de-10-minutos">Guia inicial de 10 minutos</a></li> <li><a href="../controllers-rest">Controllers Rest</a></li> <li><a href="../componentes">Componentes</a></li> <li><a href="../conversores">Conversores</a></li> <li><a href="../validacao">Validação</a></li> <li><a href="../interceptadores">Interceptadores</a></li> <li><a href="../eventos">Eventos</a></li> <li><a href="../trabalhando-com-a-view">Trabalhando com a View</a></li> <li><a href="../download-e-upload">Download e Upload</a></li> <li><a href="../environment">Environment</a></li> <li><a href="../plugins">Plugins</a></li> <li><a href=".">Dependências e pré requisitos</a></li> <li><a href="../testando-componentes-e-controllers">Testando Componentes e Controllers</a></li> <li><a href="../migrando-de-um-projeto-com-vraptor3">Migrando de um projeto com VRaptor 3</a></li> <li><a href="../contribuindo-com-o-vraptor">Contribuindo com o VRaptor</a></li> <li><a href="../artigos-e-apresentacoes">Artigos e Apresentações</a></li> </ul> </nav> <main class="container doc-container"> <h1 id="dependncias-e-pr-requisitos">Dependências e pré-requisitos</h1> <p>O VRaptor 4 depende diretamente do CDI versão 1.1, portanto só funcionará nos servidores que suportem essa versão do CDI ou superior como CDI 1.2. Também é necessário possuir JDK 1.7 ou superior.</p> <p>Os Servidores de Aplicações já testados e suportados são:</p> <ul> <li>Glassfish 4</li> <li>WildFly 8</li> </ul> <p>E os Servlet Containers suportados são:</p> <ul> <li>Tomcat 7 (+ jars do Weld 2.0)</li> <li>Jetty 8 e 9 (+ jars do Weld 2.0)</li> </ul> <p>Ao usar um Servlet Container como o Tomcat ou Jetty, é preciso adicionar os jars do Weld 2.x, além do seguinte listener em seu <code>web.xml</code>, para que seja possível ativar o CDI:</p> <pre><code class="language-xml"><span class="nt">&lt;listener&gt;</span>
    <span class="nt">&lt;listener-class&gt;</span>org.jboss.weld.environment.servlet.Listener<span class="nt">&lt;/listener-class&gt;</span>
<span class="nt">&lt;/listener&gt;</span></code></pre> <p>E o arquivo <code>beans.xml</code>, que é opcional se você estiver usando um Application Server, que deve estar dentro do <code>WEB-INF</code> de sua aplicação:</p> <pre><code class="language-xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee"</span>
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/beans_1_1.xsd"</span>
    <span class="na">version=</span><span class="s">"1.1"</span> <span class="na">bean-discovery-mode=</span><span class="s">"all"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/beans&gt;</span></code></pre> <p>Algumas dependências podem variar se você usa um Application Server ou um Servlet Container. Pacotes da especificação, como o CDI ou Bean Validation, não são necessários quando você usa um Application Server.</p> <h1 id="jdk-8">JDK 8</h1> <p>É possível usar JDK 8 com o VRaptor. Porém é importante atualizar a dependência do Javassist para a última versão, pois as anteriores ainda não possuem suporte ao bytecode gerado pelo Java 8.</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.javassist<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>javassist<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.18.1-GA<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p><strong>Nota</strong>: Se você usa Wildfly, tente usar a versão 8.1, pois o Javassist já é disponibilizado nos módulos do servidor. Sendo assim mesmo que você defina a dependência na aplicação, ela será ignorada. Uma alternativa, se você não pode usar a versão 8.1, é atualizar o módulo direto no servidor.</p> <h2 id="maven">Maven</h2> <p>O VRaptor 4 usa como padrão o Maven para gerenciar as dependências. Com isso basta você adicionar o artefato do vraptor como dependência, e o Maven irá se encarregar de fazer o download de todas as dependências obrigatórias.</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>br.com.caelum<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>vraptor<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>4.0.0<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!--ou a última versão--&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>A estrutura do projeto baseado no Maven é um pouco diferente da estrutura convencional usada pelas IDEs. No entanto quando o projeto é empacotado, o Maven irá gerar a estrutura padrão de um WAR.</p> <table class="content-table"> <tbody> <tr> <td>Local Maven</td> <td>Descrição</td> <td>Local no pacote WAR</td> </tr> <tr> <td>src/main/java</td> <td>fontes Java</td> <td>/WEB-INF/classes</td> </tr> <tr> <td>src/main/resources</td> <td>arquivos de configuração</td> <td>/WEB-INF/classes</td> </tr> <tr> <td>src/main/webapp</td> <td>arquivos web</td> <td>/</td> </tr> <tr> <td>src/test/java</td> <td>fontes Java para testes</td> <td>- ignorado -</td> </tr> <tr> <td>src/test/resources</td> <td>arquivos de config. para testes</td> <td>- ignorado -</td> </tr> </tbody> </table> <p>Se você não quiser usar o Maven, basta criar um projeto em branco na sua IDE preferida e adicionar o jar do VRaptor com as dependências. Todos os jars necessários para usar o VRaptor estão disponibilizados no <code>zip</code> em nossa <a href="../../download">página de downloads</a>.</p> <h3 id="cdi">CDI</h3> <p>Esta é a dependência mais importante do VRaptor 4. Se você usa um Application Server, ele já possui esta dependência, portanto você pode declarar no seu <code>pom.xml</code> como <code>provided</code> conforme exemplo:</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>javax.inject<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>javax.inject<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>E se você utiliza um Servlet Container (como o Tomcat ou Jetty) você precisa remover a linha <code>&lt;scope&gt;provided&lt;/scope&gt;</code> da dependência <code>javax.inject</code> e adicionar a implementação de referência do CDI: o Weld.</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.jboss.weld.servlet<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>weld-servlet-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.1.2.Final<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.jboss.weld<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>weld-core-impl<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.1.2.Final<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p><strong>Observação importante</strong>: evite usar o artefato <code>org.jboss.weld.servlet:weld-servlet</code>. Este artefato contém todas as classes necessárias, porém contém mais classes do que é preciso para subir a sua aplicação. Em particular, o <code>weld-servlet</code> contém uma <strong>cópia</strong> de todo o código do guava, que já é dependência do VRaptor, o que pode gerar conflitos entre as classes dos dois artefatos.</p> <h2 id="logging">Logging</h2> <p>Utilizamos o SLF4J (Simple Logging Facade for Java) para imprimir os logs dos eventos internos. SLF4J pode direcionar o logging para vários frameworks de logging como NOP, Simple, log4j e JDK Logging. Para configurar o logging você precisa adicionar no seu classpath o jar <code>slf4j-api.jar</code> juntamente com o jar de binding que você escolher. Veja mais sobre o assunto na <a href="http://www.slf4j.org/manual.html">documentação do SLF4J</a>.</p> <p>A maioria dos projetos preferem usar o <em>log4j</em> como implementação de logging. Caso você queira usá-lo, basta adicionar nas dependências do projeto o seguinte artefato:</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.7.5<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- ou a última versão disponível --&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>E inclua um arquivo de configuração chamado <code>log4j.xml</code> na pasta de <code>src/main/resources</code> do projeto, por exemplo:</p> <pre><code class="language-xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;</span>
<span class="nt">&lt;log4j:configuration</span> <span class="na">xmlns:log4j=</span><span class="s">"http://jakarta.apache.org/log4j/"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"stdout"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"org.apache.log4j.PatternLayout"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ConversionPattern"</span> <span class="na">value=</span><span class="s">"%d{HH:mm:ss,SSS} %5p [%-20c{1}] %m%n"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">name=</span><span class="s">"br.com.caelum.vraptor"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;priority</span> <span class="na">value=</span><span class="s">"DEBUG"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"stdout"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/category&gt;</span>
    <span class="c">&lt;!-- incluir outras definições aqui --&gt;</span>
<span class="nt">&lt;/log4j:configuration&gt;</span></code></pre> <p><strong>Nota:</strong> Se você está fazendo deploy de sua aplicação no Wildfly, você precisará configurar o logging no arquivo <code>standalone.xml</code> (ou no <code>domain.xml</code> se você estiver executando em modo domain):</p> <pre><code class="language-xml"><span class="nt">&lt;subsystem</span> <span class="na">xmlns=</span><span class="s">"urn:jboss:domain:logging:2.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">category=</span><span class="s">"br.com.caelum.vraptor"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">name=</span><span class="s">"DEBUG"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="c">&lt;!-- restante do conteúdo --&gt;</span>
<span class="nt">&lt;/subsystem&gt;</span></code></pre> <p>Porém se você preferir usar as configurações dentro de sua aplicação usando exemplo de <code>log4j.xml</code> acima, você pode indicar ao Wildfly para que ele considere a configuração na aplicação:</p> <pre><code class="language-xml"><span class="nt">&lt;subsystem</span> <span class="na">xmlns=</span><span class="s">"urn:jboss:domain:logging:2.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;use-deployment-logging-config</span> <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- restante do conteúdo --&gt;</span>
<span class="nt">&lt;/subsystem&gt;</span></code></pre> <h2 id="xstream-e-gson">XStream e Gson</h2> <p>São utililizadas para serialização e deserialização XML e JSON respectivamente. Ambas são opcionais, ou seja, se você não usar os recursos de serialização e deserialização, você pode removê-los do classpath. Atualmente elas já vêm com a dependência do VRaptor no Maven e você não precisa declarar as dependências.</p> <p>Para XStream:</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.thoughtworks.xstream<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>xstream<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.4.4<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>E para o Gson</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.google.code.gson<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>gson<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.2.4<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <h2 id="bean-validation">Bean Validation</h2> <p>Se você usa um servidor de aplicações não é necessário adicionar a dependência do <em>Bean Validation</em>, pois já está incluído no Java EE 7. Porém se você usar apenas um <em>servlet container</em>, é necessário adicionar alguma implementação, como o <em>Hibernate validator</em>, em seu projeto incluindo o artefato:</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.hibernate<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>hibernate-validator-cdi<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>5.1.1.Final<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>Esta dependência é obrigatória pois o VRaptor utiliza os recursos de validação do bean validation em sua classe <code>Validator</code>. </p> <p>É necessário também indicar ao CDI para não validar os métodos automaticamente. Para isso adicione o arquivo <code>META-INF/validation.xml</code> com o segunte conteúdo:</p> <pre><code class="language-xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;validation-config</span> <span class="na">xmlns=</span><span class="s">"http://jboss.org/xml/ns/javax/validation/configuration"</span>
        <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
        <span class="na">xsi:schemaLocation=</span><span class="s">"http://jboss.org/xml/ns/javax/validation/configuration</span>
<span class="s">        validation-configuration-1.1.xsd"</span>
        <span class="na">version=</span><span class="s">"1.1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;executable-validation</span> <span class="na">enabled=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/validation-config&gt;</span></code></pre> <h2 id="paranamer">Paranamer</h2> <p>Infelizmente, nas versões anteriores ao Java 8, não é possível fazer reflection de parâmetros em métodos e construtores, pois esses dados não ficam disponíveis em bytecode (a não ser se compilado em <strong>debug mode</strong>, porém é algo opcional). Isso faz com que a maioria dos frameworks que precisem desse tipo de informação criem uma anotação própria para isso, o que polui muito o código (exemplo no JAX-WS, onde é comum encontrar um método como o acima com a assinatura <code>void add(@WebParam(name="cliente") Cliente cliente)</code>. </p> <p>O VRaptor tira proveito do framework <a href="http://paranamer.codehaus.org/">Paranamer</a>, que consegue tirar essa informação por meio da pré compilação ou dos dados de debug, evitando criar mais uma anotação. Alguns dos desenvolvedores do VRaptor também participam no desenvolvimento do <strong>Paranamer</strong>.</p> <h2 id="commons-fileupload">Commons-fileupload</h2> <p>Dependência opcional utilizada apenas se sua aplicação possui funcionalidade de upload de arquivos. Se você não usa o Maven, será necessário adicionar também a biblioteca <code>commons-io</code> no classpath.</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>commons-fileupload<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>commons-fileupload<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.3<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <h2 id="iogi">Iogi</h2> <p>O <strong>Iogi</strong> é uma biblioteca usada internamente pelo VRaptor para injeção de parâmetros da requisição. A grande vantagem do Iogi é permitir que seus beans possam ser imutáveis, ou seja, instanciados apenas pelo construtor. Ou da forma usual, por meio de <em>setters</em> and <em>getters</em>.</p> <p>Iogi é uma dependência obrigatória e já vem incluída por padrão se você usa Maven.</p> <h2 id="mirror">Mirror</h2> <p>A biblioteca Mirror permite instanciar beans via <em>Reflection</em> usando uma interface fluente. É usada internamente para instanciar os objetos.</p> <p>Mirror é uma dependência obrigatória e já vem incluída por padrão se você usa Maven.</p> </main> <script src="../../../js/search-pt.js"></script> <script src="/js/headers.min.js"></script> </body> </html>